<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>BonsaiJS - A Graphics and Animation JavaScript Library</title>

		<meta name="description" content="BonsaiJS ">
		<meta name="author" content="Tobias Reiss">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<script src="js/bonsai-0.4.1.min.js"></script>

		<!-- online //-->
		<script src="//use.typekit.net/vdv4wzo.js"></script>
		<script>try{Typekit.load();}catch(e){}</script>

		<!-- offline
		<style type="text/css">
			@font-face {
  			font-family: 'freight-sans-pro';
  			src: local("FreightSansBook");
			}
		</style>
		//-->

		<link rel="stylesheet" href="reveal.js/css/reset.css">
		<link rel="stylesheet" href="reveal.js/css/main.css">
		<link rel="stylesheet" href="main.css">

		<script>
			window.currentMovie;
			window.lastMovie;

			// special `bonsai.run` that uses a globel `movie` variable for
			// all movies and makes sure to destroy all previously created
			// movies
			bonsai.slideRun = function(domNode, codeFunc, options) {

				options = options || {};

				var movie;

				if (domNode.childNodes.length) {
					domNode.innerText = '';
				}

				if (typeof codeFunc === 'function') {
					// got just the code
					movie = bonsai.run(domNode, {
						width: options.width || 440,
						height: options.height || 440,
						framerate: options.fps || 60,
						code: codeFunc,
						plugins: options.plugins || []
					});
				} else {
					// got all options
					movie = bonsai.run.apply(bonsai, arguments);
				}

				window.lastMovie = window.currentMovie;
				window.currentMovie = movie;

				return movie;
			};


			// If the query includes print-pdf we'll use the fancy print CSS
			document.write( '<link rel="stylesheet" href="reveal.js/css/' + (window.location.search.match( /print-pdf/gi ) ? 'print-pdf.css' : 'print.css') + '" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Used to fade in a background when a specific slide state is reached -->
			<div class="state-background"></div>

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<p style="margin-top:7%;">
						<img src="img/1.svg"/>
					</p>
					<p style="margin-top:40px; font-size:0.7em;">
						Tobias Reiss,&nbsp;&nbsp;Software Developer,&nbsp;&nbsp;Uxebu Inc.
					</p>
				</section>

				<section data-state="stop-thegraphicalweblogo">
					<h2>Agenda</h2>
					<ul>
						<li>Introduction</li>
						<li>API</li>
						<li>Architecture</li>
					</ul>
				</section>

				<section>
					<h2>Facts</h2>
					<ul>
						<li>Graphics library written in JavaScript</li>
						<li>SVG renderer</li>
						<li>Open Source</li>
						<li>API is still in flux</li>
						<li><a href="http://www.bonsaijs.org/">bonsaijs.org</a></li>
					</ul>
				</section>

				<section data-state="star-demo">
					<div class="movie infographic"></div>
				</section>

				<section data-state="pie-chart-demo">
					<div class="movie infographic"></div>
				</section>

				<section>
					<h2>Essential Features</h2>
					<ul>
						<li>Draw Shapes, Bitmaps and Text</li>
						<li>Groups, Movieclips, Plugins</li>
						<li>Animations, Filters, Mask</li>
						<li>Load Fonts, Bitmaps, Audio, Video, (Sub-)Movies</li>
						<li>Architecturally decoupled renderer and runner</li>
					</ul>
				</section>

				<section>
					<img src="img/pixelpant-screenshot.png" width="811" height="600" alt="screenshot of pixelplant" />
				</section>

				<section>
					<h2>Pixelplant</h2>
					<ul>
						<li>Converts Flash to HTML5
							<br/>
							✓ ActionScript 2
							<br/>
							✓ ActionScript 3
							<br/>
							✓ SWF 1-11
						</li>
						<li>Bonsai is the graphics library behind Pixelplant</li>
						<li>Bonsai is "flavored" with Flash API (Movie API)</li>
						<li><a href="http://www.pixelplant.com/">pixelplant.com</a></li>
					</ul>
				</section>

				<section>
					<h1>API</h1>
				</section>

				<!-- PONG //-->
				<section>
					<h2>Setup stage</h2>
					<div class="code" style="width:100%">
						<span class="comment">&lt;!-- element where we place a graphics context //--></span>
						<br>&lt;div id="stage">&lt;/div>
						<br>
						<br><span class="comment">&lt;!-- load latest Bonsai version //--></span>
						<br>&lt;script src="bonsai.min.js"></script>
						<br>&lt;script>
						<br><span class="comment">&nbsp;&nbsp;// run movie</span>
						<br>&nbsp;&nbsp;<span class="instance">bonsai</span>.<span class="inst-method">run</span>(document.querySelector(<span class="aString">'#stage'</span>), <span class="aString">'movie.js'</span>);
						<br>&lt;/script>
					</div>
				</section>

				<section>
					<h2>Setup movie.js</h2>
					<ul>
						<li>runs in an sandboxed environment</li>
						<li><span class="inlineCode">stage</span> is a Movie instance and globally available</li>
						<li>whatever you add to <span class="inlineCode">stage</span> is going to be drawn</li>
					</ul>
					<div class="code" style="height:auto; line-height:3em; width:100%">
						new <span class="instance">Text</span>(<span class="aString">'Hello world'</span>).<span class="inst-method">addTo</span>(<span class="stage">stage</span>);
					</div>
				</section>

				<section>
					<h2>Let's play!</h2>
					<div class="movie">
						&nbsp;
					</div>
					<div class="code">
						/* Pong */
					</div>
				</section>

				<section data-state="draw-a-bitmap">
					<h2>Draw a Bitmap</h2>
					<div class="movie"></div>
					<div class="code">
						new <span class="instance">Bitmap</span>(<span class="aString">'bg.png'</span>)<br>
						&nbsp;.<span class="inst-method">addTo</span>(<span class="stage">stage</span>);
					</div>
				</section>

				<section>
					<section data-state="apply-a-filter">
						<h2>Apply a Filter</h2>
						<div class="movie pong"></div>
						<div class="code">
							new <span class="instance">Bitmap</span>(<span class="aString">'bg.jpg'</span>)
							&nbsp;.<span class="inst-method">addTo</span>(<span class="stage">stage</span>)<br>
							&nbsp;.<span class="inst-method">attr</span>(<span class="aString">'filters'</span>, [<br>
							&nbsp;&nbsp;&nbsp;&nbsp;<span class="instance">filter</span>.<span class="inst-method">opacity</span>(0.7),<br>
							&nbsp;&nbsp;&nbsp;&nbsp;<span class="instance">filter</span>.<span class="inst-method">blur</span>(5)<br>
							&nbsp;&nbsp;]);
						</div>
					</section>
					<section data-state="apply-a-grayscale-filter">
						<h2>Grayscale</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="instance">filter</span>.<span class="inst-method">grayscale</span>(1)
						</div>
					</section>
					<section data-state="apply-a-sepia-filter">
						<h2>Sepia</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="instance">filter</span>.<span class="inst-method">sepia</span>(0.5)
						</div>
					</section>
					<section data-state="apply-a-invert-filter">
						<h2>Invert</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="instance">filter</span>.<span class="inst-method">invert</span>(2)
						</div>
					</section>
				</section>

				<section>
					<section data-state="draw-a-simple-shapes">
						<h2>Draw simple shapes</h2>
						<div class="movie pong"></div>
						<div class="code">
							<span class="comment">// top paddle</span><br>
							new <span class="instance">Rect</span>(0, 0, 100, 30, 10)
							<br>&nbsp;.<span class="inst-method">fill</span>(<span class="aString">'#0077FF'</span>)
							<br>&nbsp;.<span class="inst-method">addTo</span>(<span class="stage">stage</span>);
							<br><br>
							<span class="comment">// ball</span><br>
							new <span class="instance">Circle</span>(210, 210, 20)
							<br>&nbsp;.<span class="inst-method">fill</span>(<span class="aString">'white'</span>)
							<br>&nbsp;.<span class="inst-method">addTo</span>(<span class="stage">stage</span>);
						</div>
					</section>
					<section data-state="draw-a-star">
						<h2>More simple shapes</h2>
						<div class="movie"></div>
						<div class="code">
							new <span class="instance">Star</span>(120, 120, 40, 6, 3)
							<br><br>
							new <span class="instance">Ellipse</span>(50, 50, 100, 50)
							<br><br>
							new <span class="instance">Polygon</span>(330, 330, 80, 6)
						</div>
					</section>
					<section data-state="draw-a-path">
						<h2>Path</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="comment">// SVG like syntax</span>
							<br>new <span class="instance">Path</span>(<span class="aString">'M21,20...z'</span>)
							<br><br>
							<span class="comment">// PostScript like operators</span>
							<br>new <span class="instance">Path</span>()
							<br>&nbsp;.<span class="inst-method">moveTo</span>(21, 20)
							<br>&nbsp;.<span class="inst-method">curveBy</span>(…)
							<br>&nbsp;.<span class="inst-method">closePath</span>();
							<br><span class="comment" style="font-size:13px">// http://thenounproject.com/noun/cloud-upload/#icon-No2633</span>
						</div>
					</section>
				</section>

				<section>
					<section data-state="apply-colors">
						<h2>Apply colors</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="comment">// key name</span>
							<br>.<span class="inst-method">fill</span>(<span class="aString">'white'</span>)
							<br><br>
							<span class="comment">// hex</span>
							<br>.<span class="inst-method">fill</span>(<span class="aString">'#fff'</span>)
							<br><br>
							<span class="comment">// rgb</span>
							<br>.<span class="inst-method">fill</span>(<span class="aString">'rgb(255, 255, 255)'</span>)
						</div>
					</section>
					<section data-state="color-function">
						<h2>color function</h2>
						<div class="movie" style="background-color:white;"></div>
						<div class="code">
							<span class="instance">color</span>(<span class="aString">'red'</span>)
							<br><span class="instance">color</span>(<span class="aString">'#F00'</span>)
							<br><span class="instance">color</span>(<span class="aString">'#FF0000'</span>)
							<br><span class="instance">color</span>(<span class="aString">'#FF0000FF'</span>)
							<br><span class="instance">color</span>(<span class="aString">'rgb(255,0,0)'</span>)
							<br><span class="instance">color</span>(<span class="aString">'rgba(255,0,0,1)'</span>)
							<br><span class="instance">color</span>(<span class="aString">'hsl(0,100%,50%)'</span>)
							<br><span class="instance">color</span>(<span class="aString">'hsla(0,100%,50%,1)'</span>)
						</div>
					</section>
					<section data-state="color-manipulation">
						<h2>manipulate colors</h2>
						<div class="movie" style="background-color:white;"></div>
						<div class="code">
							var red = <span class="instance">color</span>(<span class="aString">'red'</span>);
							<br>red.<span class="inst-method">lighter</span>(0.2)
							<br>red.<span class="inst-method">darker</span>(0.2)
							<br>red.<span class="inst-method">midpoint</span>(<span class="aString">'blue'</span>)
							<br>red.<span class="inst-method">randomize</span>(<span class="aString">'hue'</span>)
						</div>
					</section>
				</section>

				<section>
					<section data-state="apply-gradient">
						<h2>Apply gradients</h2>
						<div class="movie pong"></div>
						<div class="code">
							var blue = <span class="instance">color</span>(<span class="aString">'#0077FF'</span>);
							<br>var g = <span class="instance">gradient</span>.<span class="inst-method">linear</span>(180, [
							<br>&nbsp;&nbsp;blue,
							<br>&nbsp;&nbsp;blue.<span class="inst-method">darker</span>(0.3)
							<br>]);
							<br>paddle.<span class="inst-method">fill</span>(g);
						</div>
					</section>
					<section data-state="radial-gradient">
						<h2>Radial Gradients</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="instance">gradient</span>.<span class="inst-method">radial</span>([
							<br>&nbsp;&nbsp;<span class="aString">'yellow'</span>,
							<br>&nbsp;&nbsp;<span class="aString">'red'</span>
							<br>])
						</div>
					</section>
				</section>

				<section>
					<section data-state="change-position">
						<h2>Change the position</h2>
						<div class="movie pong"></div>
						<div class="code">
							<span class="comment">// the blue paddle</span>
							<br>cpPaddle.<span class="inst-method">attr</span>(<span class="aString">'x'</span>, 200);
							<br><span class="comment">// the yellow paddle</span>
							<br>myPaddle.<span class="inst-method">attr</span>(<span class="aString">'x'</span>, 200);
						</div>
					</section>
					<section data-state="apply-other-transformations">
						<h2>Scale &amp; Rotate</h2>
						<div class="movie"></div>
						<div class="code">
							<span class="inst-method">attr</span>(<span class="aString">'scale'</span>, 2)
							<br><span class="inst-method">attr</span>(<span class="aString">'rotate'</span>, Math.PI)
						</div>
					</section>
				</section>

				<section data-state="pointer-events">
					<h2>Listen to pointer events</h2>
					<div class="movie pong"></div>
					<div class="code">
						var f = function(e) {
						<br>&nbsp;&nbsp;myPaddle.<span class="inst-method">attr</span>({
						<br>&nbsp;&nbsp;&nbsp;x: e.stageX
						<br>&nbsp;&nbsp;});
						<br>};
						<br><span class="stage">stage</span>.<span class="inst-method">on</span>(<span class="aString">'pointermove'</span>, f);
					</div>
				</section>

				<section>
					<section data-state="animate-ball">
						<h2>Animate ball</h2>
						<div class="movie pong"></div>
						<div class="code">
							ball.<span class="inst-method">attr</span>({
							<br>&nbsp;&nbsp;opacity: 0,
							<br>&nbsp;&nbsp;scale: 0.1
							<br>});
							<br>
							<br>ball.<span class="inst-method">animate</span>(<span class="aString">'0.8s'</span>, {
							<br>&nbsp;&nbsp;opacity: 1,
							<br>&nbsp;&nbsp;scale: 1
							<br>}, { easing: <span class="aString">'elasticOut'</span> });
						</div>
					</section>
					<section data-state="keyframe-animation">
						<h2>Keyframe Animation</h2>
						<div class="movie"></div>
						<div class="code">
							new <span class="instance">KeyframeAnimation</span>(<span class="aString">'3s'</span>, {
							<br>&nbsp;<span class="aString">'50%'</span>: {fillGradient: g1},
							<br>&nbsp;<span class="aString">'100%'</span>: {fillGradient: g0}
							<br>}, {
							<br>&nbsp;repeat: Infinity
							<br>});
						</div>
					</section>
					<section data-state="morphto-animation">
						<h2>Morphing</h2>
						<div class="movie"></div>
						<div class="code">
							var earth = new <span class="instance">Path</span>(…);
							<br>var ball = new <span class="instance">Path</span>(…);
							<br>
							<br>earth.<span class="inst-method">morphTo</span>(ball, <span class="aString">'2s'</span>);
						</div>
					</section>
				</section>

				<section data-state="tick-event">
					<h2>Update screen every 16ms </h2>
					<div class="movie pong"></div>
					<div class="code">
						<span class="stage">stage</span>.<span class="inst-method">on</span>(<span class="aString">'tick'</span>, function() {
						<br>&nbsp;ball.<span class="inst-method">attr</span>({x: tx, y: ty});
						<br>&nbsp;// plugin
						<br>&nbsp;walls.<span class="inst-method">on</span>(<span class="aString">'hit'</span>, updBall);
						<br>&nbsp;paddles.<span class="inst-method">on</span>(<span class="aString">'hit'</span>, updBall);
						<br>});
					</div>
				</section>

				<section data-state="apply-audio">
					<h2>Apply audio</h2>
					<div class="movie pong"></div>
					<div class="code">
						var a = new <span class="instance">Audio</span>(<span class="aString">'pong.mp3'</span>)
						<br>&nbsp;.<span class="inst-method">addTo</span>(<span class="stage">stage</span>);
						<br>
						<br><span class="comment">// on hit</span>
						<br>a.<span class="inst-method">play</span>();
					</div>
				</section>

				<section data-state="custom-messages">
					<h2>Custom messages</h2>
					<div class="movie pong"></div>
					<div class="code">
						<span class="comment">// your website</span>
						<br>var movie = <span class="instance">bonsai</span>.<span class="inst-method">run</span>(…);
						<br>movie.<span class="inst-method">sendMessage</span>(aMessage);
						<br>
						<br><span class="comment">// your movie</span>
						<br>function f(pos) {
						<br>&nbsp;&nbsp;myPaddle.<span class="inst-method">attr</span>(<span class="aString">'x'</span>, pos);
						<br>}
						<br><span class="stage">stage</span>.<span class="inst-method">on</span>(<span class="aString">'message'</span>, f);
						<br>
					</div>
				</section>

				<section>
					<section data-state="submovie-loading">
						<h2>Submovie loading</h2>
						<div class="movie pong"></div>
						<div class="code">
							i = new <span class="instance">Movie</span>(<span class="aString">'intro.js'</span>);
							<br>p = new <span class="instance">Movie</span>(<span class="aString">'pong.js'</span>);
							<br>
							<br>p.<span class="inst-method">on</span>(<span class="aString">'load'</span>, function() {
							<br>&nbsp;&nbsp;i.<span class="inst-method">destroy</span>();
							<br>&nbsp;&nbsp;p.<span class="inst-method">play</span>();
							<br>});
						</div>
					</section>
					<section data-state="movie-timeline">
						<h2>Movie's Timeline</h2>
						<div class="movie pong"></div>
						<div class="code">
							new <span class="instance">Movie</span>()
							<br>.<span class="inst-method">length</span>(240).<span class="inst-method">frames</span>({
							<br>&nbsp;&nbsp;<span class="aString">'0%'</span>: function red(){…},
							<br>&nbsp;&nbsp;<span class="aString">'25%'</span>: function blue(){…},
							<br>&nbsp;&nbsp;<span class="aString">'50%'</span>: function green(){…},
							<br>&nbsp;&nbsp;<span class="aString">'75%'</span>: function yellow() {
							<br>&nbsp;&nbsp;&nbsp;&nbsp;new <span class="instance">Rect</span>(…).<span class="inst-method">addTo</span>(this);
							<br>&nbsp;&nbsp;&nbsp;&nbsp;this.<span class="inst-method">stop</span>();
							<br>&nbsp;&nbsp;}
							<br>})
						</div>
					</section>
				</section>

				<section>
					<h2>DisplayObjects</h2>
					<ul>
						<li>Path (Rect, Star, Circle, Arc)</li>
						<li>Bitmap</li>
						<li>Text</li>
						<li>Audio</li>
					</ul>
				</section>

				<section>
					<h2>Attributes</h2>
					<ul>
						<li>Style and transform DisplayObjects</li>
						<li>Animatable</li>
					</ul>
				</section>

				<section>
					<h2>Container</h2>
					<ul>
						<li>Group</li>
						<li>Movie (with Timeline)</li>
					</ul>
				</section>

				<section>
					<h1>Architecture</h1>
				</section>

				<section>
					<h2>Overview</h2>
					<img src="img/4.svg" />
				</section>

				<section>
					<h2>Messaging Protocol</h2>
					<img src="img/7.svg" />
				</section>

				<section data-state="why-architecture">
					<h2>Frame Budget</h2>
					<div class="movie infographic"></div>
					<div class="fragment" data-fragment-index="1"></div>
					<div class="fragment" data-fragment-index="2"></div>
					<div class="fragment" data-fragment-index="3"></div>
				</section>

				<section data-state="runner-front">
					<img style="margin-top:20%;" src="img/runner-front.svg" />
				</section>

				<section>
					<h2>Runner Context</h2>
					<ul>
						<li>Web Worker (Default)</li>
						<li>iFrame (Development)</li>
						<li>Node (e.g. with socket.io)</li>
					</ul>
				</section>

				<section data-state="renderer-front">
					<img style="margin-top:20%;" src="img/renderer-front.svg" />
				</section>

				<section>
					<h2>Available Renderer</h2>
					<ul>
						<li>SVG (present)</li>
						<li>HTML5 (in work)</li>
						<li>Canvas (near future)</li>
						<li>WebGL (future)</li>
					</ul>
				</section>

				<section>
					<h2>Why SVG?</h2>
					<ul>
						<li>We love SVG's API</li>
						<li>SVG can handle most of the drawing-instructions by default</li>
					</ul>
				</section>

				<!--
				<section>
					<h1>Orbit</h1>
					<p>A realtime Bonsai Editor</p>
				</section>
				//-->

				<section>
					<h2>One Renderer per Runner</h2>
					<img src="img/3.svg" />
				</section>

				<section>
					<h2>Multiple Renderer</h2>
					<img src="img/6.svg" />
				</section>

				<section>
					<h2>Benefits</h2>
					<ul>
						<li>Decoupled computation and logic from drawing</li>
						<li>One Messaging Protocol for </li>
						<li>Renderer may block the main thread, not the Runner</li>
						<li>Rich and simple API</li>
						<li>Open Source</li>
					</ul>
				</section>


				<section>
					<h2>Where to find what</h2>
					<ul>
						<li>
							Code: <a href="http://github.com/uxebu/bonsai">http://github.com/uxebu/bonsai</a>
						</li>
						<li>
							Website: <a href="http://bonsaijs.org">http://bonsaijs.org</a>
						</li>
						<li>
							Docs: <a href="http://docs.bonsaijs.org">http://docs.bonsaijs.org</a>
						</li>
						<li>
							Demos: <a href="http://demos.bonsaijs.org">http://demos.bonsaijs.org</a>
						</li>
						<li>
							Play: <a href="http://orbit.bonsaijs.org">http://orbit.bonsaijs.org</a>
						</li>
					</ul>
				</section>

				<section>
					<h2>&nbsp;</h2>
					<h2>Thank You</h2>
					<p>Follow <a href="http://twitter.com/bonsaijs">@bonsaijs</a> or go on <a href="http://www.bonsaijs.org/">bonsaijs.org</a></p>
					<p style="margin-top:40px; font-size:0.7em;">reiss@uxebu.com,&nbsp;&nbsp;@basecode</p>
				</section>
			</div>

			<!-- The navigational controls UI -->
			<aside class="controls">
				<a class="left" href="#">&#x25C4;</a>
				<a class="right" href="#">&#x25BA;</a>
				<a class="up" href="#">&#x25B2;</a>
				<a class="down" href="#">&#x25BC;</a>
			</aside>

			<!-- Presentation progress bar -->
			<div class="progress"><span></span></div>

		</div>

		<script src="reveal.js/lib/js/head.min.js"></script>

		<script>
			function getStageFromDataState(id) {
				return document.querySelector('[data-state=' + id + '] .movie');
			}

			head.ready( function() {

				Reveal.addEventListener('draw-a-bitmap', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							this.addTo(stage).attr('width', 430).attr('y', 170);
						});
					});
				}, false);

				Reveal.addEventListener('apply-a-filter', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.7), filter.blur(5)]);
						});
					});
				}, false);

				Reveal.addEventListener('apply-a-grayscale-filter', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/berlin.jpg').on('load', function() {
							this.addTo(stage).attr('filters', filter.grayscale(1))
								.addTo(stage);
						});
					});
				}, false);

				Reveal.addEventListener('apply-a-sepia-filter', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/berlin.jpg').on('load', function() {
							this.addTo(stage).attr('filters', filter.sepia(1))
							.addTo(stage);
						});
					});
				}, false);

				Reveal.addEventListener('apply-a-invert-filter', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/berlin.jpg').on('load', function() {
							this.addTo(stage).attr('filters', filter.invert(2))
							.addTo(stage);
						});
					});
				}, false);

				Reveal.addEventListener('draw-a-simple-shapes', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.5), filter.blur(5)]);
						});
						// top paddle
						new Rect(0, 0, 100, 30, 10).fill('#0077FF').addTo(stage);
						// bottom paddle
						new Rect(0, 410, 100, 30, 10).fill('#FF9500').addTo(stage);
						// ball
						new Circle(210, 210, 15).fill('white').addTo(stage);
					});
				}, false);

				Reveal.addEventListener('draw-a-star', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Star(120, 160, 40, 6, 3).fill('yellow').addTo(stage);
						new Ellipse(320, 80, 100, 50).fill('orange').addTo(stage);
						new Polygon(320, 320, 80, 6).fill('purple').addTo(stage);
						//new Star(320, 320, 80, 6, 1).fill('yellow').addTo(stage);
					});
				}, false);

				Reveal.addEventListener('draw-a-path', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Path('M72.732,72.73c-1.892,0-5.283,0-9.278,0c0.058-0.498,0.148-0.981,0.148-1.492v-7.601c3.82,0,7.11,0,9.13,0c10.042,0,18.18-8.142,18.18-18.18c0-10.042-8.138-18.184-18.18-18.184c-2.797,0-5.43,0.657-7.791,1.792l-3.681-3.678C57.042,15.803,47.514,9.092,36.366,9.092c-15.063,0-27.272,12.209-27.272,27.272c0,15.051,12.191,27.25,27.237,27.273v7.601c0,0.513,0.095,0.997,0.15,1.492c-0.037,0-0.08,0-0.117,0C16.28,72.73,0,56.45,0,36.365C0,16.282,16.28,0,36.364,0c13.648,0,25.524,7.528,31.744,18.648c1.51-0.26,3.039-0.466,4.619-0.466C87.791,18.182,100,30.394,100,45.458C100.004,60.517,87.795,72.73,72.732,72.73zM33.898,49.449c-1.774-1.771-1.774-4.652,0-6.424l12.857-12.859c1.772-1.776,4.654-1.776,6.427,0l12.855,12.859c1.775,1.771,1.775,4.652,0,6.424c-1.774,1.775-4.653,1.775-6.427,0l-5.099-5.097v26.886c0,2.509-2.036,4.546-4.543,4.546c-2.512,0-4.546-2.037-4.546-4.546V44.353l-5.097,5.097C38.552,51.225,35.674,51.225,33.898,49.449z').fill('white').attr({
							 x: 130,
							 y: 120,
							 scale: 2
						}).addTo(stage);
					});
				}, false);

				Reveal.addEventListener('apply-colors', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.9), filter.blur(5)]);
						});
						// top paddle
						new Rect(0, 0, 100, 30, 10).fill('#0077FF').addTo(stage);
						// bottom paddle
						new Rect(0, 410, 100, 30, 10).fill('#FF9500').addTo(stage);
						// ball
						new Circle(210, 210, 15).fill('white').addTo(stage);
					});
				}, false);

				Reveal.addEventListener('color-function', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						var aRect = new Rect(110, 110, 110, 110).fill('red').addTo(stage);
						aRect.clone().attr({x: 222, y:110}).fill('red').addTo(stage);
						aRect.clone().attr({x: 110, y:222}).fill('red').addTo(stage);
						aRect.clone().attr({x: 222, y:222}).fill('red').addTo(stage);
					});
				}, false);

				Reveal.addEventListener('color-manipulation', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						var red = color('red');
						var aRect = new Rect(110, 110, 110, 110)
							.fill(red.lighter(0.2))
							.addTo(stage);
						aRect.clone().attr({x: 222, y:110})
							.fill(red.darker(0.2)).addTo(stage);
						aRect.clone().attr({x: 110, y:222})
							.fill(red.midpoint('blue')).addTo(stage);
						aRect.clone().attr({x: 222, y:222})
							.fill(red.randomize('hue')).addTo(stage);
					});
				}, false);

				Reveal.addEventListener('apply-gradient', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							// ball
						new Circle(210, 210, 15).fill('white').addTo(stage);

						this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.9), filter.blur(5)]);

						// top paddle
						var aGradient = gradient.linear(180, [
							'#0077FF',
							color('#0077FF').darker(0.3)
						]);
						new Rect(0, 0, 100, 30, 10).addTo(stage).fill(aGradient);
						// bottom paddle
						new Rect(0, 410, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#FF9500', color('#FF9500').darker(0.3)]));
						});
					});
				}, false);

				Reveal.addEventListener('radial-gradient', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Circle(220, 220, 150).fill(
					    gradient.radial(['yellow', 'red'])
					  ).addTo(stage);
					});
				}, false);

				Reveal.addEventListener('change-position', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							// ball
							new Circle(210, 210, 15).fill('white').addTo(stage);

							this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.9), filter.blur(5)]);

							// top paddle
							new Rect(160, 0, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#0077FF', color('#0077FF').darker(0.3)]));
							// bottom paddle
							new Rect(160, 410, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#FF9500', color('#FF9500').darker(0.3)]));
						});
					});
				}, false);

				Reveal.addEventListener('apply-other-transformations', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						var aGradient = gradient.linear(180,
							['#FF9500', color('#FF9500').darker(0.3)]);
						new Rect(160, 210, 100, 30, 10).addTo(stage).fill(aGradient).attr({
							scale: 2,
							rotation: Math.PI/6
						});
					});
				}, false);

				Reveal.addEventListener('pointer-events', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							// ball
							new Circle(210, 210, 15).fill('white').addTo(stage);

							this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.9), filter.blur(5)]);

							// top paddle
							new Rect(160, 0, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#0077FF', color('#0077FF').darker(0.3)]));
							// bottom paddle
							var userPaddle = new Rect(160, 410, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#FF9500', color('#FF9500').darker(0.3)]));
							var paddleWidth = userPaddle.attr('width');
							stage.on('pointermove', function(e) {
								userPaddle.attr('x', Math.max(0, Math.min(stage.width-paddleWidth, e.stageX - paddleWidth/2)));
							});
						});

					});
				}, false);

				Reveal.addEventListener('animate-ball', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							// ball
							var anim = new Animation('1s', {
								opacity: 1,
								scale: 1
							}, { easing: 'elasticOut' });
							new Circle(210, 210, 15).attr({
								fillColor: 'white',
								opacity: 0,
								scale: 0.0
							}).addTo(stage).animate(anim);

							stage.on('pointerdown', function() {
								anim.play();
							});

							// bg
							this.addTo(stage).attr('width', 430).attr('y', 170).attr('filters', [filter.opacity(0.9), filter.blur(5)]);
							// top paddle
							new Rect(160, 0, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#0077FF', color('#0077FF').darker(0.3)]));
							// bottom paddle
							var userPaddle = new Rect(160, 410, 100, 30, 10).addTo(stage).fill(gradient.linear(180, ['#FF9500', color('#FF9500').darker(0.3)]));
							var paddleWidth = userPaddle.attr('width');
							stage.on('pointermove', function(e) {
								userPaddle.attr('x', Math.max(0, Math.min(stage.width-paddleWidth, e.stageX - paddleWidth/2)));
							});
						});

					});
				}, false);

				Reveal.addEventListener('keyframe-animation', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						var g0 = gradient.linear(90, [
							'rgb(189, 36, 67)',
							['white', 0.1],
							'rgb(189, 36, 67)'
						]);
						var g1 = gradient.linear(90, [
							'rgb(189, 36, 67)',
							['white', 100],
							'rgb(189, 36, 67)'
						]);
						var anim = new KeyframeAnimation('3s', {
							'50%': { fillGradient: g1 },
							'100%': { fillGradient: g0 }
						}, { repeat: Infinity });
						new Bitmap('img/rejectjs-logo_big.png').on('load', function() {
							this.addTo(stage).attr({
								width: 300,
								x: 70,
								y: 185,
								filters: [filter.opacity(0.9), filter.blur(3)]
							});
						});
						new Rect(0, 170, 440, 80).fill(g0)
							.attr('filters', filter.dropShadow(0, 0, 14, '#000'))
							.addTo(stage).animate(anim);
					});
				}, false);

				Reveal.addEventListener('morphto-animation', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {

						var shape = new Group().attr({
							scale: 3,
							x: 80,
							y: 80
						}).addTo(stage);

						var football = new Path('M 48 0.406 C 28.7 0.948 10.4 13.8 3.47 31.8 C -3.98 49.9 0.885 72.2 15.1 85.6 C 28.3 98.6 49.1 103 66.6 96.8 C 85.2 90.8 98.9 72.6 100 53.2 C 102 34.4 90.8 15.5 74.4 6.69 C 67 2.54 58.4 0.391 49.8 0.406 C 49.2 0.398 48.6 0.389 48 0.406 z M 65.5 7.56 C 72.9 10.5 80 15 84.4 21.6 C 85.2 24.3 90 30.2 86.3 31.7 L 74 36.1 C 69.2 33 64 29.8 59.2 26.7 C 58 21.1 56.6 15.5 55.1 9.94 C 58 8.08 61.7 7.64 65.5 7.56 z M 40.2 8.28 C 43.9 8.54 48 8.9 51.7 9.94 C 53.2 15.5 54.7 21.1 55.8 26.8 C 51.3 30.4 46.9 34 42.4 37.6 C 35.3 36.6 28.2 35.6 21.1 34.5 C 20.2 29.7 18.2 23.7 22.9 20.2 C 27.5 14.9 33.3 10.1 40.2 8.28 z M 30.3 9.41 C 25.4 12.8 21.2 17.1 17.6 21.9 C 15.1 22.7 10.5 28 14.1 23.2 C 18.3 17.4 23.9 12.6 30.3 9.41 z M 88.5 34.1 C 91.5 37.4 93.8 41.7 94.1 46.2 C 94.5 53.2 93 60.7 90.4 67.4 L 90 66.6 L 90 66.2 C 86.3 68.9 79.6 75.2 78.1 67.8 C 76.3 63.7 72.9 59.9 71.8 55.8 C 73.7 50.6 74.4 44.7 75.2 39.1 C 79.6 37.4 84.1 35.8 88.5 34.1 z M 20.4 37.6 C 27.3 38.7 34.3 39.5 41.3 40.6 C 43.5 46.5 45.7 52.5 48.7 58.1 C 44.6 64 40.6 70.4 35.9 75.9 C 31.1 75.6 26.5 74.1 22.1 72.6 C 17.7 65.5 15.1 57.7 12.9 49.9 C 14.9 45.4 17.4 41.3 20.4 37.6 z M 5.94 47.6 C 6.87 47.5 9.53 51.3 10.3 52.1 C 12.5 59.9 15.2 67.4 19.3 74.1 C 18.6 76.7 21.4 84.1 17.5 78.9 C 9.99 71.1 5.68 59.9 5.72 49.2 C 5.51 48 5.63 47.6 5.94 47.6 z M 68.8 58.4 C 72.5 63.6 75.9 68.9 78.1 74.4 C 76.3 78.5 72.9 81.5 69.6 84.5 C 62.1 87.8 53.2 88.6 45.4 86.3 C 43.5 83.4 37 79.3 39.8 75.9 C 43.9 70.7 47.6 65.1 51.3 59.9 C 57.3 59.6 62.9 59.6 68.8 58.4 z M 70.7 87.8 C 69.6 89.3 63.6 91.2 60.2 91.9 C 56.9 93 53.6 93.4 49.8 93.4 C 46.9 93.4 40.6 92.7 39.8 91.9 C 44.3 90 49.1 90.1 53.9 90.8 C 59.5 91.2 65.1 89.7 70.7 87.8 z ').fill('white');

						var earth = new Path('M 50 2.56 C 23.8 2.56 2.56 23.8 2.56 50 C 2.56 76.2 23.8 97.4 50 97.4 C 76.2 97.4 97.4 76.2 97.4 50 C 97.4 23.8 76.2 2.56 50 2.56 z M 48.4 4.66 C 52 4.56 55.8 4.86 59.2 5.5 C 59.9 5.65 60.6 5.81 61.3 6 C 62.5 6.3 63.7 6.64 64.8 7.03 C 63.9 7.98 64.3 10.7 65.6 10.9 C 66.4 11 66.7 10.4 67.6 10.2 C 67.8 11 68.3 11.6 68.8 12.1 C 68.8 12.7 67.9 12.3 68 13.1 C 68.3 13.8 69.9 13.9 70.5 13.6 C 70.6 12.5 70.6 11.2 71.4 10.9 C 71.6 10.1 70.9 10.3 70.8 9.69 C 71.1 9.79 71.4 9.91 71.6 10.1 C 71.6 10.1 71.6 10.1 71.7 10.1 C 72.4 10.5 73 11 73.8 11.3 C 73.9 11.4 73.9 11.4 74 11.4 C 73.6 12.3 74.5 12.5 74.5 13.3 C 73.9 13.4 74.1 12.6 73.5 12.7 C 72.7 13 72.9 14.3 72.5 14.9 C 71.1 14.4 69.8 15.6 68.5 14.4 C 68.9 13.6 68 13.7 67.7 13.2 C 68 12.3 68 11.9 67.7 11 C 66 11.1 66.3 12.9 66.8 13.9 C 66.3 14 65.4 14 64.8 14.2 C 64.3 14.7 64.3 15.5 63.3 15.4 C 62.9 15.1 63.7 14.8 63.3 14.4 C 63.1 14.2 62.7 14.2 62.4 14.1 C 62.4 13.2 61.9 12.9 61.3 12.6 C 61.4 12.2 61.5 11.7 60.8 11.8 C 60.8 11.2 61.2 11.3 61.2 10.8 C 61.1 10.5 60.8 10.3 60.3 10.4 C 60.2 10.1 60.5 10.1 60.5 9.81 C 60.3 9.61 59.8 9.71 59.4 9.69 C 58.8 10 58.9 11.1 58.4 11.5 C 58.3 11.9 59 11.6 58.9 12 C 59 12.5 58.3 12.2 58.3 12 C 57.5 12.3 57.3 13 56.3 12.8 C 56.4 13.3 56.5 13.8 56.5 14.4 C 56.8 14.7 57.3 14.8 57.6 15.2 C 58.3 15 58.8 14.7 59.1 14.2 L 59.1 13.1 C 59.4 13 59.7 12.8 60.1 12.8 C 60 13.3 60.5 13.2 60.3 13.7 C 60 13.7 59.8 13.7 59.6 13.8 C 59.5 14.3 59.8 14.4 59.8 14.8 C 59.5 14.8 59.2 14.8 59 14.9 C 59.1 15.3 59.3 15.4 59.8 15.3 C 59.7 15.8 59.2 15.8 59 16.2 C 59.9 16.5 61.3 16.4 62.1 16.2 C 61.8 16.8 62.5 16.5 62.4 16.9 C 61.2 16.3 61.2 17.4 59.8 17.1 C 59.6 17.3 59.6 17.6 59.6 18 C 60.7 18.5 62.3 19.2 61.6 21.1 C 59.8 21.4 57.9 20.2 56.9 21.2 C 57.7 22.7 56.8 24.2 57.1 25.7 C 57.8 25.9 58.8 25.7 59.2 26.2 C 58.9 26.6 58.5 26.9 58.5 27.6 C 56.7 28 57 30.4 55.8 31.5 C 53.7 32.3 53.1 34.8 51.8 36.5 C 52.9 37.6 52.4 39.9 51.7 41 C 51.9 41.4 52.2 41.7 52.1 42.5 C 52.4 43.1 53.1 43.3 53.7 43.7 C 54.5 45.6 55.5 48.1 57.6 48.3 C 58.5 48.4 58.9 47.6 59.8 47.6 C 60.5 47.6 60.7 48.1 61.6 48.2 C 62.8 47.9 64 46.7 65.2 47 C 66.3 47.2 67 49 68.3 48.1 C 68.7 48.9 68.6 50.6 68.2 51.3 C 68.6 52.9 69.8 53.8 70.1 55.5 C 72.4 57.1 69.8 59.6 70 61.7 C 70.1 62.8 71 63.6 71.2 64.8 C 71.5 67 72.2 68.7 73.3 70.4 C 73.3 70.7 72.9 70.6 73 71.1 C 73.5 73 75.5 71 76.7 71.5 C 77.9 70.7 79.2 70.2 79.6 68.7 C 81.1 68.1 81.2 66 82 64.6 L 82.7 64.6 C 83.1 64 83.1 62.6 82.7 62 C 83.2 60.8 84.3 60.2 85.2 59.4 C 85.3 57.9 85.9 56.9 85.5 55.8 C 85.3 55.2 84.5 54.9 84.5 54.4 C 84.2 52.5 86.7 52 86.9 49.9 C 87.2 49.8 87.4 49.5 87.7 49.4 C 88 47.3 89.5 45.6 89.3 43.3 C 88.4 43.8 87.3 43.9 86.4 44 C 86.1 43.6 86.6 43.4 86.8 43.1 C 85.8 41.5 83.8 39.9 84.1 37.8 C 83.3 36.8 82.4 35.2 82.3 33.8 C 83 33.7 83.3 35 83.5 35.8 C 83.6 36.2 84.1 36.3 84.3 36.8 C 84.5 39 86.2 39.6 86.3 41.8 C 86.8 42.2 86.7 43.1 87.4 43.3 C 87.9 43.4 87.8 42.9 87.8 42.5 C 89.1 41.6 90.7 41 91.8 39.9 C 91.8 39 92.3 38.9 92.3 38.2 C 92.2 37.4 91.2 37.1 91.2 36.2 C 92 36.3 92.5 36.8 93.4 36.7 C 93.6 37.2 93.8 37.8 93.9 38.4 C 94 38.6 94.1 38.9 94.1 39.2 C 94.2 39.5 94.3 39.7 94.3 40 C 94.4 40.6 94.6 41.2 94.7 41.8 C 95.2 44.6 95.4 47.7 95.3 50.9 C 95 58.3 93.3 64.8 90.6 70.4 C 90.3 70.9 90.1 71.3 89.8 71.8 C 89.4 72.7 88.8 73.6 88.3 74.4 C 88.3 74.4 88.3 74.4 88.3 74.4 C 88.3 74.4 88.3 74.5 88.2 74.5 C 88 74.9 87.7 75.3 87.4 75.7 C 82.9 82.3 76.6 87.4 69.6 90.8 C 68 90.7 66.7 90.6 66 91.6 C 65.2 91.5 64.9 91.1 64.2 91.4 C 64.3 90.8 63.1 91.3 63 90.7 C 61.1 91 59.3 91.2 57.8 91.9 C 57.2 92.2 56.9 92.8 56.3 92.9 C 56 93 55.5 92.7 55.1 92.8 C 54.1 92.9 52.2 94.4 51 94.6 C 50.4 94.7 49.8 94.6 49.1 94.6 C 48 95.2 46.5 95.3 44.8 95.1 C 44.8 95.1 44.8 95.1 44.8 95.1 C 44.6 95.1 44.4 95.1 44.2 95.1 C 43.9 95 43.5 95 43.2 94.9 C 43.1 94.9 43.1 94.9 43.1 94.9 C 40.9 94.5 38.7 93.9 37.3 93.4 C 37.3 93 37.7 92.9 37.6 92.4 C 35.6 91.2 34.3 89.5 32.4 88.3 C 32.4 87.3 33.2 87.2 33.9 87.1 C 33.4 85.9 30.9 86.4 31 88 C 31 88.6 31.4 88.5 31.5 89.2 C 30.9 89 30.8 88.3 30.1 88.2 C 30.5 87.9 30.4 87.3 29.9 87.3 C 29.3 87.2 29.7 88 29.4 88.2 C 28.8 88.2 28.8 88 28.3 88.2 C 28.4 88.9 29.3 89.1 29.9 88.8 C 30.1 89.2 30.1 89.4 29.9 89.8 C 30.3 90.5 31.5 90.5 32.2 90.3 C 32.4 90.4 32.2 90 32.1 90 C 32.3 89.6 32.6 90.3 32.7 90.6 C 31.3 91.2 30 90.8 28.5 90 C 28.5 90 28.4 90 28.3 89.9 C 28.1 89.8 27.9 89.7 27.7 89.5 C 27.1 89.2 26.5 88.8 25.9 88.4 C 15.4 81.7 6.34 69.5 4.91 54.9 C 4.29 48.6 4.84 41.5 6.84 36.8 C 7.24 37.3 7.09 38.3 7.59 38.7 C 8.41 38.2 7.33 36.7 7.34 35.9 C 7.6 36.7 8.34 37.4 8.56 38.3 C 8.69 38.8 8.39 39.1 8.44 39.5 C 8.58 41 9.73 41.1 11 42.1 C 11.6 42.3 11.5 41.7 12 41.7 C 12.3 43.4 14.7 43 14.8 44.9 C 15 45.3 15.6 45.4 15.6 46 C 16.3 45.9 16.2 46.4 17 46.5 C 17.2 46.3 17 45.7 17.5 45.8 C 18.1 46.3 18.1 47.4 18.1 48.6 C 17.6 49.7 16.1 51.3 17.2 52.4 C 16.3 53.4 17.3 55 18.1 55.4 C 18.5 57.2 19.2 58.7 20.2 59.9 C 21.3 60.1 21.7 60.9 22.2 61.6 C 22.2 64.2 22.5 66.4 22.8 68.7 C 23 69.9 22.5 71.1 22.6 72.3 C 22.6 74 23.9 75 23.7 76.8 C 23.5 76.8 23.2 76.8 23.2 76.9 C 23 77.7 23.6 77.5 23.8 77.9 C 24.3 79.7 24.7 81.6 26.3 82.2 C 26.7 82.2 26.4 81.6 26.7 81.6 C 26.8 81.3 26.8 82.6 26.4 82.6 C 26.9 83.3 28.5 83.8 29.5 83.4 C 28.5 82.6 27.5 81.8 26.8 80.5 C 27.2 80 27.5 79.4 27.8 78.8 C 27.7 78.2 27.1 78.2 26.8 77.8 C 26.7 77.3 27.4 77.5 27.6 77.3 C 27.4 77.1 27.5 76.7 27.5 76.3 C 27.6 76.2 28 76.3 28.1 76 C 28.1 75.3 27.1 75.8 27.2 75.1 C 27.5 75.2 27.9 75.3 28.3 75.2 C 28.5 74.8 28.3 74.4 28.3 74 C 30.1 74.7 31.1 73.3 30.2 72 C 30.6 72 31.1 71.9 31.2 72.1 C 32.7 71.2 33.1 69.4 34.2 68.2 C 34.2 67.6 33.9 67.3 34 66.7 C 34.5 66 35.5 65.7 36.1 65.1 C 36.7 65.1 37.1 65.3 37.6 65.1 C 38.7 64.7 39.1 61.2 38.9 59.3 C 39.4 58.9 41.7 56.5 41.2 55.1 C 40.7 53.6 37.4 52.1 35.1 52.3 C 34.6 51 33.1 51.2 32 50.6 C 31.5 48.4 30.6 46.7 27.8 47 C 27.3 45.7 25.5 45.3 25.4 44.1 C 24.6 44 24.1 44.1 23.8 44.5 C 23.4 44.2 23.1 44.4 22.5 44.4 C 22.3 44 21.8 43.8 21.6 43.3 C 21.1 43.3 21.1 43.7 20.9 43.2 C 19.9 43.6 18.8 44.1 18.6 45.2 C 18.1 45 17.1 44.7 16.4 45.2 C 15.1 44.2 17.2 40.5 14.1 41.5 C 14.3 40.5 14.7 39.6 14.9 38.7 C 15.2 38.7 15.6 38.7 15.9 39 C 16.2 38.5 16.8 38.2 17.7 38.3 C 17.7 36.7 16 36.7 14.7 37 C 14.3 36.4 13.1 35.5 11.9 35.1 C 12.2 34.7 12.6 34.4 13.1 34.2 C 13.7 34.1 13.7 34.6 14.2 34.7 C 14.5 34.5 14.6 34.2 14.5 33.7 C 15.5 33.5 15.6 33.9 16.4 33.7 C 16.5 34.7 16.7 35.6 17.1 36.4 C 18.5 35.2 16.9 33.1 17.8 31.6 C 18.5 30.6 19.8 30.6 20.2 29.3 C 20.2 28.9 20.1 28.7 20 28.4 C 20.8 28 21 27 21.4 26.2 C 22.2 26 22.4 25.1 23.2 24.9 C 23.3 24.4 22.8 24.7 22.9 24.2 C 23.3 23.4 24.4 23.3 24.9 22.7 C 25.1 22.9 24.8 23.4 25.2 23.7 C 25.9 23.1 26.9 22.8 27.7 22.2 C 27.8 21.7 27.5 21.6 27.1 21.5 C 27.1 21.1 27.6 21.3 27.6 20.9 C 27.5 20.5 26.7 20.8 26.4 20.5 C 26.5 19.5 27.5 20.1 28.2 19.6 C 28.3 19 27.4 19.3 27.2 19.1 C 28 18.6 29.3 18.8 29.4 17.7 C 30.5 17.6 31.1 16.9 31.3 15.9 C 31.3 15.3 30.4 15.5 30.5 14.7 C 30.1 14.7 29.7 14.7 29.4 14.6 C 29.1 13.4 28.8 12.2 28.4 11.2 C 28 11.2 27.8 11.4 27.7 11.6 C 27.2 12 26.9 12.4 26.5 12.8 C 26.5 12.6 26.2 12.6 26 12.5 C 26.2 12 26.5 11.5 26.7 11 C 26.7 11 26.7 11 26.7 11 C 26.8 11 26.9 10.9 26.9 10.9 C 29.5 9.53 32 8.12 35 7.25 C 35.4 7.42 35.5 7.93 36 7.97 C 35.8 8.47 35.8 8.71 36.1 9.09 C 36.6 9.18 36.8 8.97 37.2 8.97 C 37.5 9.13 37.5 9.46 37.8 9.56 C 38.7 8.99 40 8.15 39.7 7 C 40.2 6.73 40.3 6.02 40.6 5.56 C 40.7 5.54 40.8 5.52 40.8 5.5 C 41.4 5.39 41.9 5.28 42.5 5.19 C 42.6 5.17 42.7 5.17 42.8 5.16 C 43.3 5.07 43.9 5.01 44.4 4.94 C 45.7 4.8 47.1 4.69 48.4 4.66 z M 22.3 14.4 C 22.3 15.9 21.3 16.3 20.6 17 C 20.9 17.7 21 19 20 19.1 C 19.6 18.4 19.9 17.6 20 16.9 C 20.1 16.6 19.6 16.8 19.4 16.8 C 19.8 16.3 20.2 15.8 20.7 15.3 C 21.2 14.9 21.8 14.5 22.3 14.4 z M 62.9 15.9 L 63 15.9 C 63.2 15.9 63 16.6 62.8 16.5 C 62.7 16.2 63 16.2 62.9 15.9 z M 26.5 18.9 L 26.8 18.9 C 26.8 19.5 26 19.4 25.6 19.7 C 25.3 19.6 25.8 19.2 25.8 19.1 C 26.1 19.1 26.3 19 26.5 18.9 z M 84.6 20.8 C 85.3 21.7 86.2 22.4 86.8 23.4 C 87.1 24 87.4 24.6 87.5 25.5 C 88 26.2 88.5 26.8 88.5 27.8 C 87.1 27.9 86.3 27 86.4 25.8 C 86.7 25.5 87.1 25.2 87.2 24.8 C 86.9 24.6 86.7 24.6 86.4 24.6 C 85.5 23.6 84.7 22.2 84.6 20.8 z M 79 20.9 C 79.6 20.9 79.6 21.4 80.2 21.2 C 80.1 21.6 80.2 21.7 80.3 22 C 80.9 21.7 81.4 22 81.9 22.1 C 82 21.7 81.7 21.6 81.4 21.5 C 81.6 21.2 82.3 21.5 82.5 21.2 C 82.5 21.5 82.6 21.7 82.8 21.8 C 82.8 22 82.3 21.8 82.2 21.9 C 82.6 23.2 84.4 23.1 84.7 24.6 C 84 24.6 83.4 24.4 82.8 24.2 C 82.4 24 81.6 23.5 81 23.7 C 80.3 23.5 79.5 23.4 78.6 23.7 C 78.4 23.4 78.2 23.1 77.9 22.8 C 78.3 22.2 78.6 21.5 79 20.9 z M 26.2 21.1 C 26.5 21.2 26.7 21.3 27 21.4 C 26.9 21.6 26.1 21.5 26.2 21.1 z M 67.7 21.1 C 68.6 22.7 70.9 23 71.3 25 C 70.7 25.1 70.1 25.3 69.5 24.9 C 69.3 25.6 70.1 26.3 70.5 26.8 C 70.8 26.8 70.9 26.6 71.2 26.6 C 71.2 26.2 71.1 25.9 71.1 25.7 C 71.4 25.6 71.7 26 71.9 25.8 C 72 25.4 72.3 25.2 72.7 25.2 C 72.7 24.7 72.4 24.7 72.4 24.3 C 72.8 24.3 73 24.9 73.4 24.6 C 73.4 23.5 72.2 23.6 72.1 22.7 C 72.8 22.5 73 22.8 73.5 23.1 C 73.8 25.1 74.5 26.7 76.2 27.3 C 76.4 27.4 76.4 26.8 76.2 26.9 C 76.3 26.5 76.5 27 76.7 27 C 77 27 76.6 26.4 77 26.6 C 76.7 25.7 76.6 25.3 76.6 24.1 C 77.5 24.1 77.4 25.5 77.4 26.1 C 78 26.9 78.8 28 80.2 27.6 C 80.6 27.6 80.6 28 80.9 28.1 C 81.5 28.1 81.7 27.8 82.3 27.8 C 82.2 29 82.2 29.9 82 31.1 C 79.7 30.9 77.3 30.7 76.1 29.2 C 75.7 29.6 74.7 29.2 74.4 29.7 C 74.3 30.2 74.5 30.4 74.5 31 C 72.6 30.3 71.5 28.8 69.6 28.1 C 69.9 27.1 69.1 26.9 69.4 26.2 C 69 26.1 68.7 26 68.4 25.8 C 68 25.8 67.8 26 67.5 26.1 C 66 25.9 64.7 25.8 63.3 26.1 C 62 26.4 60.6 27.5 59.4 26.4 C 61 26.3 62.1 25.9 62.9 25 C 62.6 23 64.5 23 64.8 21.5 C 65.9 21.9 66.8 21.6 67.7 21.1 z M 17 22 C 17.3 22.1 17.6 22.3 17.6 22.8 C 17.2 22.7 17.1 23 16.7 23 C 16.9 22.6 16.9 22.6 16.4 22.6 C 16.6 22.4 16.9 22.3 17 22 z M 16 22.7 C 16.2 22.8 16 22.9 16 23.1 C 15.8 23 16 22.9 16 22.7 z M 17.9 23.2 C 18.3 23.4 18.4 23.2 18.9 23.2 C 18.9 23.4 19.1 23.5 19 23.7 C 18.5 23.2 18.4 24 18.3 24.3 C 18.2 24 18 23.6 17.9 23.2 z M 87.8 25 C 87.9 25 87.9 25 88 25.1 C 88 25.1 88 25.1 88.1 25.2 C 88.1 25.2 88.1 25.2 88.1 25.2 C 88.1 25.3 88.1 25.4 88.1 25.5 C 87.8 25.6 87.7 25.3 87.8 25 z M 87.4 33 C 88.7 33.3 88.4 35.2 89.7 35.6 C 90.3 35.7 90.3 35.3 90.8 35.3 C 90.4 35.9 90.3 36.7 89.2 36.6 C 88.9 36.3 88.9 35.7 88.9 35.2 C 88.6 34.9 88.4 35.1 88.1 35.2 C 87.9 34.4 87.4 33.9 87.4 33 z M 11.5 36.1 C 12.2 36.3 12.7 36.8 12.7 37.6 C 13.7 37.7 14.1 37.3 14.7 37.2 C 14.7 37.4 14.9 37.5 14.9 37.8 C 14.5 37.7 14.1 37.7 14.2 38.2 L 14.2 38.3 C 13.9 38.3 13.6 38.6 13.4 38.9 C 12.9 37.9 11.8 39.7 13.1 39.6 C 12.8 40 12.5 40.5 11.8 40.3 C 11.3 39.1 11.1 37.4 11.5 36.1 z M 18.7 37.7 C 18.4 37.7 18.1 37.8 18 37.9 L 18 38.4 C 18.4 38.7 19.5 38.6 19.3 37.9 C 19.2 37.8 18.9 37.7 18.7 37.7 z M 21 43.7 C 21.4 43.8 21.1 44.3 20.8 44.3 C 20.7 44 20.9 43.9 21 43.7 z M 87.5 57.4 C 86.9 58 87.3 58.5 87 59 C 86.5 60 85.1 60.1 84.6 60.8 C 84 61.7 83.8 63.3 84.2 64 C 83.3 65 82.8 66.6 83.6 68.1 C 84.7 68 85.1 67.2 85.7 66.6 C 85.7 66.2 85.9 66 85.8 65.5 C 86.5 65 86.5 64.3 86.8 63.2 C 87.2 61.5 89.2 58.7 87.5 57.4 z M 18 79 C 18 79.6 17.9 80.4 18.6 80.4 C 19.2 80.1 18.8 78.8 18 79 z M 26.2 86.1 C 26 86.8 26.1 86.9 26.4 87.3 C 26.9 87.2 27.3 87.1 27.3 86.4 C 26.9 86.3 26.6 86.2 26.2 86.1 z M 28 86.8 C 27.9 87.2 27.6 87.3 27.6 87.7 C 28 88.1 28.4 87.6 28.8 87.6 C 28.8 87.1 28.4 86.9 28 86.8 z ').fill('white').addTo(shape);

						stage.on('pointerdown', function() {
							earth.morphTo(football, '2s');
						});
					});
				}, false);

				Reveal.addEventListener('star-demo', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {}, {
						width: 500, height:500,
						plugins: ['js/star_demo.js']
					});
				});

				Reveal.addEventListener('pie-chart-demo', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {}, {
						width: 600, height: 500,
						plugins: ['js/pie_chart_demo.js']
					});
				});

				Reveal.addEventListener('tick-event', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						new Pong().start();
					}, {plugins: ['js/pong.js']});
				}, false);

				Reveal.addEventListener('apply-audio', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						Pong.sound();
						new Pong().start();
					}, {plugins: ['js/pong.js']});
				}, false);

				Reveal.addEventListener('custom-messages', function(ev) {
					var node = getStageFromDataState(ev.type);
					var movie = bonsai.slideRun(node, function() {
						Pong.sound();
						new Pong().start();
					}, {plugins: ['js/pong.js']});

					var lastG = 0, gThreshold = 0.8;

					window.addEventListener('deviceorientation', function(ev) {
						// -30 -> 0, 30 -> 440
						if (movie) {
							var g = Math.max(0, Math.min(60, ev.gamma + 30));
							if (lastG + gThreshold < g || lastG - gThreshold > g) {
								lastG = g;
								movie.sendMessage((g * 440) / 60);
							}
						}
					}, false);

				}, false);

				Reveal.addEventListener('submovie-loading', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						var style = {
							fontFamily: 'freight-sans-pro',
							fontSize: 50,
							x: 70,
							y: 180,
							textFillColor: 'white',
							filters: filter.dropShadow(0, 0, 16, '#000')
						};
						var intro = new Movie().addTo(stage);
						var left = new Text('Uxebu').attr(style).addTo(intro);
						var right = new Text('presents').attr(style).attr({x:220}).addTo(intro);

						stage.on('pointerdown', function() {
							var game = new Pong();
							game.backgroundImage.attr('opacity', 0).animate('1s', {
								opacity: 1
							});
							left.animate('0.7s', { x: -100, opacity: 0 });
							right.animate('0.7s', { x: 400, opacity: 0 }, { onEnd: function() {
								game.start();
							}});
						});
					}, {plugins: ['js/pong.js']});
				}, false);

				Reveal.addEventListener('movie-timeline', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {
						var m = new Movie().length(240);
						m.frames({
						  '0%': function() {
						  	this.aRect = new Rect(110, 110, 110, 110)
						  		.fill('red').addTo(this);
						  },
						  '25%': function() {
								this.aRect.clone().attr({x: 222, y:110})
									.fill('blue').addTo(this);
						  },
						  '50%': function() {
								this.aRect.clone().attr({x: 110, y:222})
									.fill('green').addTo(this);
						  },
						  '75%': function() {
								this.aRect.clone().attr({x: 222, y:222})
									.fill('yellow').addTo(this);
						  	this.stop();
						  }
						}).addTo(stage);
					});
				}, false);

				Reveal.addEventListener('why-architecture', function(ev) {
					bonsai.slideRun(getStageFromDataState(ev.type), function() {

						var timerRunner, paintRunner, jsRunner, newJsRunner, legendJsRunner, newLegendJsRunner;

						function createDonatChartAt(x, y) {
							var shape = new Group().attr({x:x, y:y});

							new Text('Frame').attr({
								x: -26, y: -135, textFillColor: '#7FBBC6',
								fontFamily: 'freight-sans-pro', fontSize: 20
							}).addTo(shape);

							new Arc(0, 0, 80, 0, Math.Pi/2).attr({
							  strokeWidth: 30,
							  strokeColor:'#262C35'
							}).addTo(shape);

							// arrow + frame direction
							new Arc(0, 0, 47, Math.PI*1.67, Math.PI*3.3).attr({
							  strokeWidth: 6,
							  strokeColor:'#7FBBC6'
							}).addTo(shape);
							new Star(-27, -38, 11, 3, 1).fill('#7FBBC6').attr({
								rotation: 0.7
							}).addTo(shape);
							return shape;
						}

						new Bitmap('img/renderer_runner.svg').on('load', function() {
							this.attr({x: 0, y: 0});
							this.addTo(stage);
						});

						var left = 210, top = 330;

						// legend

						new Text('JS').attr({
							x: left+80, y: top-100, textFillColor: '#f3d135'
						}).addTo(stage);

						new Text('Painting').attr({
							x: left + 100, y: top+50, textFillColor: '#F26349'
						}).addTo(stage);

						legendJsRunner = new Text('JS (next frame)').attr({
							x: left - 210, y: top-100, textFillColor: '#51B152'
						}).addTo(stage);

						// renderer

						createDonatChartAt(left, top).addTo(stage);

						timerRunner = new Arc(left, top, 80, Math.PI*1.5, Math.PI*1.8).attr({
						  strokeWidth: 30,
						  strokeColor:'#f3d135'
						}).addTo(stage);

						paintRunner = new Arc(left, top, 80, Math.PI*1.81, Math.PI*2.8).attr({
						  strokeWidth: 30,
						  strokeColor:'#F26349'
						}).addTo(stage);

						jsRunner = new Arc(left, top, 80, Math.PI*2.81, Math.PI*3.49).attr({
						  strokeWidth: 30,
						  strokeColor:'#51B152'
						}).addTo(stage);

						new Path('M'+(left-10)+','+top+'l9,-110l2,0l9,110').fill('white').addTo(stage);

						// runner

						left = 610;

						createDonatChartAt(left, top).addTo(stage);

						newJsRunner = new Arc(left, top, 80, Math.PI*1.5, Math.PI*1.51).attr({
						  strokeWidth: 30,
						  strokeColor:'#51B152'
						}).addTo(stage);

						newLegendJsRunner = new Text('JS').attr({
							x: left+70, y: top-100, textFillColor: '#51B152', opacity: 0
						}).addTo(stage);


						new Path('M'+(left-10)+','+top+'l9,-110l2,0l9,110').fill('white').addTo(stage);

						stage.on('message', function(messageId) {
							console.log(messageId);
							switch(messageId) {
								case '1':
									timerRunner.animate('0.5s', {
										opacity: 0.1
									});
									paintRunner.animate('0.5s', {
										opacity: 0.1
									});
									break;
								case '2':
									jsRunner.animate('1s', {
										endAngle: Math.PI*2.811
									});
									newJsRunner.animate('1s', {
										endAngle: Math.PI*2.3
									});
									legendJsRunner.animate('1s', {
										opacity: 0
									});
									newLegendJsRunner.animate('1s', {
										opacity: 1
									});
									timerRunner.animate('2s', {
										opacity: 1
									});
									paintRunner.animate('2s', {
										opacity: 1
									});
									break;
								case '3':
									jsRunner.animate('1s', {
										endAngle: Math.PI*2.85
									});
									newJsRunner.animate('1s', {
										endAngle: Math.PI*2.4
									});
								break;
							}
						});


					}, { width: 800, height: 600 });

				});

				Reveal.addEventListener('fragmentshown', function(ev) {
					var dataState = ev.fragment.parentNode.getAttribute('data-state');
					var index = ev.fragment.getAttribute('data-fragment-index');
					window.currentMovie.sendMessage(index);
				} );
				Reveal.addEventListener('slidechanged', function() {
					if (window.lastMovie) {
						window.lastMovie.freeze();
					}
				});

				// Full list of configuration options available here:
				// https://github.com/hakimel/reveal.js#configuration
				Reveal.initialize({
					controls: false,
					progress: true,
					history: true,
					overview: false,
					rollingLinks: false,

					theme: Reveal.getQueryHash().theme || 'default', // default/neon/beige
					transition: Reveal.getQueryHash().transition || 'default' // default/cube/page/concave/linear(2d)
				});

			});

			// Scripts that should be loaded before initializing
			var scripts = [];

			// If the browser doesn't support classList, load a polyfill
			if( !document.body.classList ) {
				head.js( 'reveal.js/lib/js/classList.js' );
			}

			scripts.push( 'reveal.js/js/reveal.js' );

			// If we're runnning the notes server we need to include some additional JS
			// TODO Is there a better way to determine if we're running the notes server?
			/*if ( typeof module !== 'undefined' && module.exports ) {
				scripts.push( 'socket.io/socket.io.js' );
				scripts.push( 'plugin/speakernotes/client.js' );
			}*/

			// Load the scripts and, when completed, initialize reveal.js
			head.js.apply( null, scripts );

		</script>

	</body>
</html>
